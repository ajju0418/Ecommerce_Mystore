<div class="admin-sales">
  <div class="sales-header">
    <div class="flex justify-between items-center">
      <div>
        <h2>Sales Management</h2>
        <p>Monitor orders and payment status</p>
      </div>
      <div class="pending-orders-badge" *ngIf="getPendingOrdersCount() > 0">
        <span class="badge-count">{{ getPendingOrdersCount() }}</span>
        <span class="badge-text">Pending Orders</span>
      </div>
    </div>
  </div>

  <!-- Stats Grid -->
  <div class="sales-stats-grid">
    <div class="stat-card">
      <div class="stat-content">
        <div class="stat-title">Total Orders</div>
        <div class="stat-value">{{ orders.length }}</div>
        <div class="stat-change trend-up">+12% this month</div>
      </div>
      <div class="stat-icon" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8);">
        <i class="bi bi-bag-check"></i>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-content">
        <div class="stat-title">Total Revenue</div>
        <div class="stat-value">₹{{ getTotalSales().toFixed(0) }}</div>
        <div class="stat-change trend-up">+8% this month</div>
      </div>
      <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
        <i class="bi bi-currency-rupee"></i>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-content">
        <div class="stat-title">Completed Orders</div>
        <div class="stat-value">{{ getCompletedOrders() }}</div>
        <div class="stat-change trend-up">+15% this month</div>
      </div>
      <div class="stat-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
        <i class="bi bi-check-circle"></i>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-content">
        <div class="stat-title">Avg Order Value</div>
        <div class="stat-value">₹{{ getAverageOrderValue().toFixed(0) }}</div>
        <div class="stat-change trend-down">-3% this month</div>
      </div>
      <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
        <i class="bi bi-graph-up"></i>
      </div>
    </div>
  </div>

  <!-- Orders Table -->
  <div class="sales-table-card">
    <div class="card-header">
      <h3>Recent Orders</h3>
      <div class="flex gap-2 items-center">
        <span class="period-label">Last 30 days</span>
      </div>
    </div>

    <div class="table-container">
      <table class="sales-table">
        <thead>
          <tr>
            <th>Order ID</th>
            <th>Customer</th>
            <th>Items</th>
            <th>Amount</th>
            <th>Date</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let order of orders">
            <td><strong>{{ order.id.substring(0, 12) }}...</strong></td>
            <td>{{ order.customerInfo.name || 'N/A' }}</td>
            <td>{{ order.items.length || 0 }} items</td>
            <td><strong style="color: #10b981;">₹{{ order.totalAmount }}</strong></td>
            <td>{{ formatDate(order.orderDate) }}</td>
            <td>
              <span class="status-badge" [class]="getStatusClass(order.status || 'pending')">
                {{ order.status || 'pending' }}
              </span>
            </td>
            <td>
              <div style="display: flex; gap: 4px; min-width: 140px;">
                <!-- Accept/Complete Button -->
                <button *ngIf="order.status === 'pending'"
                        (click)="acceptOrder(order)"
                        style="background: #10b981; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 0.75rem; cursor: pointer; flex: 1;">
                  Accept
                </button>
                <button *ngIf="order.status === 'processing'"
                        (click)="completeOrder(order)"
                        style="background: #3b82f6; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 0.75rem; cursor: pointer; flex: 1;">
                  Complete
                </button>

                <!-- Reject Button (always visible for pending/processing) -->
                <button *ngIf="order.status === 'pending' || order.status === 'processing'"
                        (click)="rejectOrder(order)"
                        style="background: #ef4444; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 0.75rem; cursor: pointer; flex: 1;">
                  Reject
                </button>

                <!-- Completed Status -->
                <span *ngIf="order.status === 'completed'"
                      style="background: #10b981; color: white; padding: 6px 12px; border-radius: 4px; font-size: 0.75rem; text-align: center; flex: 1;">
                  Completed
                </span>
              </div>
            </td>
          </tr>
          <tr *ngIf="orders.length === 0">
            <td colspan="7" style="text-align: center; padding: 40px; color: #6b7280;">
              <i class="bi bi-inbox" style="font-size: 2rem; display: block; margin-bottom: 10px;"></i>
              No orders found
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
